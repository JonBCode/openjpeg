# Client maintainer: mathieu . malaterre  gmail . com

set(CTEST_CMAKE_GENERATOR "Unix Makefiles")
set(ENV{CC} /usr/bin/tcc)
set(ENV{CFLAGS} "-Wall -funsigned-char -fno-common")

macro(dashboard_hook_init)
  set( dashboard_cache "
  BUILD_TESTING:BOOL=ON
  # cmake/tcc do not work in dynamic:
  # http://cmake.org/Bug/view.php?id=12605 (fixed!)
  # http://cmake.org/Bug/view.php?id=14803
  BUILD_SHARED_LIBS:BOOL=OFF
  # Teach CMakeDetermineCompilerABI to handle TinyCC
  # http://cmake.org/Bug/view.php?id=14792
  BUILD_THIRDPARTY:BOOL=ON
  # run cppcheck
  OPENJPEG_CPPCHECK:BOOL=ON
    "
    )
endmacro(dashboard_hook_init)

# Filename convention is:
# ctestsite-branchname-model-configuration-buildname.ctest
get_filename_component(OPJ_CTEST_NAME ${CMAKE_CURRENT_LIST_FILE} NAME_WE)
include(${CTEST_SCRIPT_DIRECTORY}/openjpeg_common.cmake)
