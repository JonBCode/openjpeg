# Client maintainer: mathieu . malaterre  gmail . com

set(CTEST_CMAKE_GENERATOR "Unix Makefiles")
set(ENV{CC} /usr/bin/gcc-4.7)
set(ENV{CFLAGS} "-Wall -Wmissing-prototypes -Wshadow -Wpointer-arith -Wstrict-prototypes -Wmissing-declarations -Wno-format-zero-length -fno-strict-aliasing -fno-builtin -fomit-frame-pointer  -Wno-long-long")
set(ENV{JFLAGS} "-Xlint:deprecation")

set(dashboard_do_memcheck TRUE)
set(CTEST_MEMORYCHECK_COMMAND           "/usr/bin/valgrind")
set(CTEST_MEMORYCHECK_COMMAND_OPTIONS   "-q --tool=memcheck --leak-check=yes --show-reachable=yes --num-callers=10")

macro(dashboard_hook_init)
  set( dashboard_cache "
  BUILD_TESTING:BOOL=ON
  BUILD_JPIP:BOOL=ON
  BUILD_JPIP_SERVER:BOOL=ON
  BUILD_THIRDPARTY:BOOL=OFF
  JPIP_SERVER:STRING=http://localhost/myFCGI
    "
    )
endmacro(dashboard_hook_init)

# Filename convention is:
# ctestsite-branchname-model-configuration-buildname.ctest
get_filename_component(OPJ_CTEST_NAME ${CMAKE_CURRENT_LIST_FILE} NAME_WE)
include(${CTEST_SCRIPT_DIRECTORY}/openjpeg_common.cmake)
